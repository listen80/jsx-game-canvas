{"version":3,"file":"bundle.js","sources":["../src/Engine/core/createNode.js","../src/Engine/core/Component.js","../src/Engine/const/baseStyle.js","../src/Engine/utils/common.js","../src/Engine/core/UI.js","../src/Engine/core/Sound.js","../src/Engine/core/patchNode.js","../src/Engine/Engine.js","../src/Game/Mota/FPS.jsx","../src/Game/Mota/Loading.jsx","../src/Game/Mota/Select.jsx","../src/Engine/utils/storage.js","../src/Game/sl.js","../src/Game/Mota/Title.jsx","../src/Game/Mota/Menu.jsx","../src/Game/Mota/Shop.jsx","../src/Game/Mota/Battle.jsx","../src/Game/Mota/Talks.jsx","../src/Engine/utils/string.js","../src/Game/Mota/Message.jsx","../src/Game/Mota/EnemyInfo.jsx","../src/Game/Mota/ShopList.jsx","../src/Game/physics.js","../src/Game/utils.js","../src/Game/Mota/Hero.jsx","../src/Game/Mota/Status.jsx","../src/Game/Mota/Map.jsx","../src/Game/Mota/ScrollText.jsx","../src/Game/http.js","../src/Game/loader.js","../src/Game/index.jsx","../src/index.js"],"sourcesContent":["export function createNode (tag, props, ...children) {\r\n  return {\r\n    tag,\r\n    props,\r\n    children,\r\n  }\r\n}\r\n","import { createNode } from './createNode'\r\nlet curFoucs = null\r\nexport { curFoucs }\r\nexport class Component {\r\n  constructor ({ props, children }) {\r\n    this.props = props\r\n    this.$children = children\r\n  }\r\n\r\n  $c (...argu) {\r\n    return createNode(...argu)\r\n  }\r\n}\r\n\r\nexport class KeyEventComponent extends Component {\r\n  constructor (...argu) {\r\n    super(...argu)\r\n    if (curFoucs) {\r\n      curFoucs.$isFocus = false\r\n      curFoucs.$nextFocus = this\r\n    }\r\n    this.$isFocus = true\r\n    this.$preFocus = curFoucs\r\n    console.warn('create\\n', this)\r\n    curFoucs = this\r\n  }\r\n\r\n  destroy () {\r\n    console.warn('destroy\\n', this)\r\n    this.$isFocus = false\r\n    if (this.$preFocus) {\r\n      this.$preFocus.$isFocus = true\r\n    }\r\n    curFoucs = this.$preFocus\r\n  }\r\n}\r\n","const fontFamily = document.fonts.check('16px 黑体') ? '黑体' : '黑体-简'\r\n\r\nexport const baseStyle = {\r\n  direction: 'ltr',\r\n  color: 'white',\r\n  // filter: \"grayscale(.1)\",\r\n  filter: 'none',\r\n  fontSize: 32,\r\n  font: '32px ' + fontFamily,\r\n  globalAlpha: 1,\r\n  globalCompositeOperation: 'source-over',\r\n  // imageSmoothingEnabled: true,\r\n  // imageSmoothingQuality: 'low',\r\n  imageSmoothingEnabled: false,\r\n  lineCap: 'butt',\r\n  lineDashOffset: 0,\r\n  lineJoin: 'miter',\r\n  lineWidth: 1,\r\n  miterLimit: 10,\r\n  shadowBlur: 0,\r\n  shadowColor: 'rgba(0, 0, 0, 0)',\r\n  shadowOffsetX: 0,\r\n  shadowOffsetY: 0,\r\n  strokeStyle: 'white',\r\n  textAlign: 'start',\r\n  // textBaseline: \"alphabetic\",\r\n  textBaseline: 'top',\r\n}\r\n","export const isPrimitive = (value) => {\r\n  const type = typeof value\r\n  return type === 'string' || type === 'number'\r\n}\r\n\r\nexport const isFunc = (f) => typeof f === 'function'\r\n\r\nexport const isArray = (a) => Array.isArray(a)\r\n\r\nexport const isUndefined = (o) => o === undefined || o === null\r\n\r\nexport const isString = (o) => typeof o === 'string'\r\n","import { baseStyle } from '../const/baseStyle'\r\nimport { isPrimitive, isFunc, isArray, isUndefined } from '../utils/common'\r\nimport { curFoucs } from './Component'\r\nconst getImage = (src) => window.$res.images[src]\r\n\r\nconst moveEvent = 'MouseMove'\r\nconst mouseEvents = ['ContextMenu', 'Click', 'Wheel', moveEvent]\r\n\r\nconst moveEventTarget = null\r\nconst mouseClickEventTarget = null\r\n//  \"MouseDown\", \"MouseUp\"\r\nconst keyEvents = ['KeyDown', 'KeyUp']\r\n\r\nexport default class UI {\r\n  constructor (screen = {}) {\r\n    const canvas = document.createElement('canvas')\r\n    this.canvas = canvas\r\n    this.context = canvas.getContext('2d')\r\n    const { el, width = 32 * (13 + 5), height = 32 * 13 } = screen\r\n    this.screen = screen\r\n    this.canvas.width = width\r\n    this.canvas.height = height\r\n    const dom = document.querySelector(el) || document.body\r\n    dom && dom.appendChild(this.canvas)\r\n    this.mergeStyle(baseStyle)\r\n\r\n    this.mouseEvents = []\r\n    this.keyEvents = []\r\n    this.onMouseClick = []\r\n    this.bind()\r\n  }\r\n\r\n  bind () {\r\n    mouseEvents.forEach((name) => {\r\n      this.canvas.addEventListener(name.toLowerCase(), (e) => {\r\n        e.name = 'on' + name\r\n        this.mouseEvents.push(e)\r\n        e.preventDefault()\r\n      }, { passive: false })\r\n    })\r\n\r\n    // const name = moveEvent\r\n    // this.canvas.addEventListener(name.toLowerCase(), (e) => {\r\n    //   e.name = 'on' + name\r\n    //   this.moveEvent = e\r\n    //   e.preventDefault()\r\n    // }, { passive: false })\r\n\r\n    keyEvents.forEach((name) => {\r\n      document.addEventListener(name.toLowerCase(), (e) => {\r\n        e.name = 'on' + name\r\n        this.keyEvents = e\r\n      })\r\n    })\r\n  }\r\n\r\n  toDataURL () {\r\n    return this.canvas.toDataURL()\r\n  }\r\n\r\n  mergeStyle = style => {\r\n    if (style) {\r\n      const { fontSize, fontFamily, font, textAlign, textBaseline, color, globalAlpha } = style\r\n      if (globalAlpha) {\r\n        this.context.globalAlpha = globalAlpha\r\n      }\r\n      if (textAlign) {\r\n        this.context.textAlign = textAlign\r\n      }\r\n      if (textBaseline) {\r\n        this.context.textBaseline = textBaseline\r\n      }\r\n      if (color) {\r\n        this.context.fillStyle = color\r\n      }\r\n      if (font) {\r\n        this.context.font = font\r\n      }\r\n      if (fontSize) {\r\n        this.context.font = this.context.font.replace(/\\d+/, fontSize)\r\n      }\r\n      if (fontFamily) {\r\n        this.context.font = this.context.font.replace(/[\\u4e00-\\u9fa5]+/, fontFamily)\r\n      }\r\n    }\r\n  };\r\n\r\n  clearRect () {\r\n    const { context, canvas } = this\r\n    context.clearRect(0, 0, canvas.width, canvas.height)\r\n  }\r\n\r\n  drawText (node, offsetX, offsetY) {\r\n    const { style, text } = node\r\n    const { context } = this\r\n    const { x = 0, y = 0 } = style\r\n    context.fillText(text, offsetX + x, offsetY + y)\r\n  }\r\n\r\n  drawImage (node, offsetX, offsetY) {\r\n    const { props } = node\r\n    if (props) {\r\n      const { style } = props\r\n      if (style) {\r\n        const { sx = 0, sy = 0, width = 32, height = 32, swidth, sheight } = style\r\n        const { context } = this\r\n        context.drawImage(getImage(props.src), sx, sy, swidth || width, sheight || height, offsetX, offsetY, width, height)\r\n      }\r\n    }\r\n  }\r\n\r\n  drawBack (node, offsetX, offsetY) {\r\n    const { context } = this\r\n    const { backgroundImage, backgroundColor, height, width } = node.props.style\r\n    if (backgroundColor) {\r\n      context.save()\r\n      context.beginPath()\r\n      context.rect(offsetX, offsetY, width, height)\r\n      context.fillStyle = backgroundColor\r\n      context.fill()\r\n      context.closePath()\r\n      context.restore()\r\n    }\r\n    if (backgroundImage) {\r\n      context.save()\r\n      context.beginPath()\r\n      context.rect(offsetX, offsetY, width, height)\r\n      context.fillStyle = context.createPattern(getImage(backgroundImage), 'repeat')\r\n      context.fill()\r\n      context.closePath()\r\n      context.restore()\r\n    }\r\n  }\r\n\r\n  drawBorder (node, offsetX, offsetY) {\r\n    const { context } = this\r\n    const { borderWidth, borderColor, height, width } = node.props.style\r\n    if (borderWidth) {\r\n      context.save()\r\n      context.lineWidth = borderWidth\r\n      context.beginPath()\r\n      context.rect(offsetX, offsetY, width, height)\r\n      if (borderColor) {\r\n        context.strokeStyle = borderColor\r\n      }\r\n      context.stroke()\r\n      context.closePath()\r\n      context.restore()\r\n    }\r\n  }\r\n\r\n  translate (box) {\r\n    const { context } = this\r\n    const { style } = box\r\n    const { x = 0, y = 0 } = style\r\n    context.translate(x, y)\r\n  }\r\n\r\n  transform (box) {\r\n    const { context } = this\r\n    const { rotate, scale } = box\r\n    if (rotate) {\r\n      const { angle = 0, x = 0, y = 0 } = rotate\r\n      context.translate(x, y)\r\n      context.rotate(angle * Math.PI / 180)\r\n      context.translate(-x, -y)\r\n    }\r\n    if (scale) {\r\n      const { x = 0, y = 0, scaleX = 1, scaleY = 1 } = scale\r\n      context.translate(x, y)\r\n      context.scale(scaleX, scaleY)\r\n      context.translate(-x, -y)\r\n    }\r\n  }\r\n\r\n  drawCircle (node, offsetX, offsetY) {\r\n    const { context } = this\r\n    context.save()\r\n    context.beginPath()\r\n    const { cx, cy, r, sAngle, eAngle, counterclockwise = false, stroke, strokeWidth } = node.props\r\n    context.arc(cx + offsetX, cy + offsetY, r, sAngle / 180 * Math.PI, eAngle / 180 * Math.PI, counterclockwise)\r\n    context.strokeStyle = stroke\r\n    context.lineWidth = strokeWidth\r\n    context.stroke()\r\n    context.closePath()\r\n    context.restore()\r\n  }\r\n\r\n  drawLine (node) {\r\n    const { context } = this\r\n    const { x1 = 0, y1 = 0, x2 = 200, y2 = 200 } = node.props\r\n    context.beginPath()\r\n    context.moveTo(x1, y1)\r\n    context.lineTo(x2, y2)\r\n    context.stroke()\r\n  }\r\n\r\n  drawRect (node, offsetX, offsetY, parent) {\r\n    const { context } = this\r\n    context.save()\r\n    const { props, tag } = node\r\n    if (props) {\r\n      const { style } = props\r\n      this.mergeStyle(style)\r\n      if (style) {\r\n        this.drawBack(node, offsetX, offsetY)\r\n        this.drawBorder(node, offsetX, offsetY)\r\n      }\r\n    }\r\n    if (tag === 'img') {\r\n      this.drawImage(node, offsetX, offsetY)\r\n    } else if (tag === 'circle') {\r\n      this.drawCircle(node, offsetX, offsetY)\r\n    } else if (tag === 'line') {\r\n      this.drawLine(node, offsetX, offsetX)\r\n    }\r\n    this.renderRect(node.children, offsetX, offsetY, node)\r\n    context.restore()\r\n  }\r\n\r\n  renderPrimitive (text, offsetX, offsetY, parent) {\r\n    const { context } = this\r\n    const { textAlign, textBaseline } = context\r\n    const { width = 0, height = 0 } = parent?.props?.style || {}\r\n    const x = { start: 0, left: 0, center: 0.5, right: 1, end: 0 }\r\n    const y = { alphabetic: 0, hanging: 0, ideographic: 0, top: 0, middle: 0.5, bottom: 1 }\r\n    // start 默认。文本在指定的位置开始。\r\n    // end 文本在指定的位置结束。\r\n    // center 文本的中心被放置在指定的位置。\r\n    // left 文本在指定的位置开始。\r\n    // right 文本在指定的位置结束。\r\n\r\n    // alphabetic 默认。文本基线是普通的字母基线。\r\n    // top 文本基线是 em 方框的顶端。\r\n    // hanging 文本基线是悬挂基线。\r\n    // middle 文本基线是 em 方框的正中。\r\n    // ideographic 文本基线是表意基线。\r\n    // bottom 文本基线是 em 方框的底端。\r\n    context.fillText(text, offsetX + width * x[textAlign], offsetY + height * y[textBaseline])\r\n  }\r\n\r\n  renderRect (node, offsetX, offsetY, parent) {\r\n    if (!isUndefined(node)) {\r\n      if (isArray(node)) {\r\n        node.forEach(child => this.renderRect(child, offsetX, offsetY, parent))\r\n      } else if (isPrimitive(node)) {\r\n        this.renderPrimitive(node, offsetX, offsetY, parent)\r\n      } else if (isFunc(node.tag)) {\r\n        this.renderRect(node.node, offsetX, offsetY, parent)\r\n      } else {\r\n        this.renderNode(node, offsetX, offsetY, parent)\r\n      }\r\n    }\r\n  }\r\n\r\n  renderNode (node, offsetX, offsetY, parent) {\r\n    const { context } = this\r\n    context.save()\r\n    const { props } = node\r\n\r\n    if (props) {\r\n      const { style } = props\r\n      if (style) {\r\n        const { x = 0, y = 0 } = style\r\n        offsetX += x\r\n        offsetY += y\r\n        this.mouseEvents.forEach((event) => {\r\n          const { name } = event\r\n          if (event.offsetX >= offsetX && event.offsetX < style.width + offsetX && event.offsetY >= offsetY && event.offsetY < style.height + offsetY) {\r\n            if (name === 'onMouseMove') {\r\n              this.onMouseMove = { node, event }\r\n            } else if (name === 'onClick') {\r\n              this.onMouseClick.push({ node, event })\r\n            }\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\n    this.drawRect(node, offsetX, offsetY, parent)\r\n\r\n    context.restore()\r\n  }\r\n\r\n  runEvent () {\r\n    if (curFoucs && this.keyEvents) {\r\n      const { name } = this.keyEvents\r\n      curFoucs[name] && curFoucs[name](this.keyEvents)\r\n    }\r\n    this.keyEvents = null\r\n    // if (this.moveEventTarget && this.moveEvent) {\r\n    //   if (moveEventTarget !== this.moveEventTarget) {\r\n    //     if (moveEventTarget) {\r\n    //       moveEventTarget.props.onMouseLeave && moveEventTarget.props.onMouseLeave()\r\n    //     }\r\n    //     moveEventTarget = this.moveEventTarget\r\n    //     moveEventTarget.props.onMouseEnter && moveEventTarget.props.onMouseEnter()\r\n    //   }\r\n    // }\r\n    this.onMouseClick.forEach(({ node, event }) => {\r\n      if (node?.props?.onClick) {\r\n        node.props.onClick(event)\r\n      }\r\n    })\r\n    this.onMouseClick = []\r\n    this.mouseEvents = []\r\n    this.moveEvent = null\r\n    this.moveEventTarget = null\r\n  }\r\n\r\n  render (root) {\r\n    this.clearRect()\r\n    this.renderRect(root, 0, 0, this.canvas)\r\n    this.runEvent()\r\n    self.$root = root\r\n  }\r\n}\r\n","export default class Sound {\r\n  current = null\r\n  constructor (Soundes) {\r\n    this.Soundes = Soundes || window.$res.sounds\r\n  }\r\n\r\n  control (type, name, control) {\r\n    this.Soundes = window.$res.sounds\r\n    this.current = this.Soundes[`${type}/${name}`]\r\n    this.current.loop = type === 'bgm'\r\n    this.current[control]()\r\n  }\r\n\r\n  play (type, name) {\r\n    this.control(type, name, 'play')\r\n  }\r\n\r\n  pause (type, name) {\r\n    this.control(type, name, 'pause')\r\n  }\r\n}\r\n","import { isFunc, isPrimitive, isArray, isUndefined, isString } from '../utils/common'\r\n\r\nfunction createInstance (next) {\r\n  const Class = next.tag\r\n  next.instance = new Class(next)\r\n  next.instance.create && next.instance.create()\r\n  renderNode(next)\r\n}\r\n\r\nfunction destoryInstance (pre) {\r\n  if (!isPrimitive(pre) && !isUndefined(pre)) {\r\n    if (isFunc(pre.tag)) {\r\n      destoryInstance(pre.node)\r\n      pre.instance.destroy && pre.instance.destroy()\r\n    } else if (isArray(pre)) {\r\n      while (pre.length) {\r\n        destoryInstance(pre.pop())\r\n      }\r\n    } else {\r\n      destoryInstance(pre.children)\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateInstance (pre, next) {\r\n  next.instance = pre.instance\r\n  next.node = pre.node\r\n  next.instance.props = next.props\r\n  renderNode(next)\r\n}\r\n\r\nfunction renderNode (next) {\r\n  next.node = patchNode(next.node, next.instance.render())\r\n}\r\n\r\nexport function patchNodeBak (pre, next) {\r\n  if (isPrimitive(next) || isUndefined(next)) {\r\n    destoryInstance(pre)\r\n  } else if (isFunc(next.tag)) {\r\n    if (pre) {\r\n      if (pre.tag === next.tag && pre.props?.key === next.props?.key) {\r\n        updateInstance(pre, next)\r\n      } else {\r\n        destoryInstance(pre)\r\n        createInstance(next)\r\n      }\r\n    } else {\r\n      createInstance(next)\r\n    }\r\n  } else if (isString(next.tag)) {\r\n    const preChildren = pre && isString(pre.tag)\r\n    for (let i = 0; i < next.children.length; i++) {\r\n      if (preChildren) {\r\n        patchNode(preChildren[i], next.children[i])\r\n      } else {\r\n        patchNode(null, next.children[i])\r\n      }\r\n    }\r\n  } else if (isArray(next)) {\r\n    if (isArray(pre)) {\r\n      for (let i = 0; i < next.length; i++) {\r\n        patchNode(pre[i], next[i])\r\n      }\r\n    } else {\r\n      destoryInstance(pre)\r\n    }\r\n  }\r\n  return next\r\n}\r\n\r\nexport function patchNode (pre, next) {\r\n  if (pre) {\r\n    if (next) {\r\n      if (isFunc(next.tag)) {\r\n        if (pre.tag === next.tag && (pre.props?.key === next.props?.key)) {\r\n          updateInstance(pre, next)\r\n        } else {\r\n          destoryInstance(pre)\r\n          createInstance(next)\r\n        }\r\n      }\r\n    } else {\r\n      destoryInstance(pre)\r\n    }\r\n  } else {\r\n    if (next) {\r\n      if (isFunc(next.tag)) {\r\n        createInstance(next)\r\n      }\r\n    }\r\n  }\r\n\r\n  const preChildren = (pre || {}).children || []\r\n  const nextChildren = (next || {}).children || []\r\n  const length = Math.max(preChildren.length, nextChildren.length)\r\n  for (let i = 0; i < length; i++) {\r\n    patchNode(preChildren[i], nextChildren[i])\r\n  }\r\n\r\n  return next\r\n}\r\n","import UI from './core/UI'\r\nimport Sound from './core/Sound'\r\nimport { createNode } from './core/createNode'\r\nimport { patchNode } from './core/patchNode'\r\nexport default class Engine {\r\n  constructor (Game) {\r\n    if (this.check()) {\r\n      this.$state = Object.create(null)\r\n      this.Game = createNode(Game, null)\r\n      this.$foucs = null\r\n      this.$sound = new Sound()\r\n      window.$sound = this.$sound\r\n      this.ui = new UI()\r\n      this.gameStart()\r\n    }\r\n  }\r\n\r\n  check () {\r\n    if (location.protocol === 'file:') {\r\n      alert('不能直接运行index.html')\r\n    } else if (!navigator.userAgent.match(/Chrome\\/(\\d+)/) || RegExp.$1 < 88) {\r\n      alert('需要chrome最新浏览器')\r\n    } else {\r\n      return true\r\n    }\r\n  }\r\n\r\n  gameStop () {\r\n    cancelAnimationFrame(this.ident)\r\n    this.ident = -1\r\n  }\r\n\r\n  gameStart () {\r\n    const frame = () => {\r\n      this.keyFrame()\r\n      this.ident = requestAnimationFrame(frame)\r\n    }\r\n    frame()\r\n  }\r\n\r\n  keyFrame () {\r\n    this.root = patchNode(this.root, this.Game, this.ui)\r\n    this.ui.render(this.root)\r\n  }\r\n}\r\n","\r\nimport { Component } from 'Engine'\r\nexport default class FPS extends Component {\r\n  fps = 60\r\n  styles = {\r\n    fps: {\r\n      textAlign: 'left',\r\n      height: 32,\r\n      x: 0,\r\n    },\r\n  }\r\n\r\n  timeStamp = +new Date();\r\n  render () {\r\n    const timeStamp = +new Date()\r\n    const fps = (1000 / (timeStamp - this.timeStamp))\r\n    const min = 30\r\n    const warn = this.fps < min && fps < min\r\n    this.fps = fps\r\n    this.timeStamp = timeStamp\r\n    return (\r\n      <div style={this.styles.fps}>\r\n        {warn ? `${this.fps.toFixed()}fps` : null}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'Engine'\r\nexport default class Loading extends Component {\r\n  step = 1\r\n  angle = -this.step\r\n  render () {\r\n    this.angle += this.step\r\n    if (this.angle > 180) {\r\n      this.angle = 0\r\n    }\r\n    const sAngle = this.angle * 2 - 90\r\n    const eAngle = Math.sin(this.angle / 180 * Math.PI) * 45\r\n    const width = 32 * (13 + 5)\r\n    const height = 32 * 13\r\n    return <div style={{ x: 0, y: 0, width, height }}>\r\n      {this.props.msg}\r\n      <circle cx={width / 2} cy={height / 2} r={32 * 3} sAngle={sAngle - eAngle} eAngle={sAngle + eAngle} stroke=\"#4e6ef2\" strokeWidth={10} />\r\n    </div>\r\n  }\r\n}\r\n","import { KeyEventComponent } from 'Engine'\r\n\r\nexport default class Select extends KeyEventComponent {\r\n  styles = {\r\n    select: {\r\n      fontSize: 24,\r\n      textAlign: 'center',\r\n      width: 320,\r\n    },\r\n  }\r\n\r\n  create () {\r\n    this.activeIndex = this.props.activeIndex || 0\r\n    const { style } = this.props\r\n    if (style) {\r\n      Object.assign(this.styles.select, style)\r\n    }\r\n  }\r\n\r\n  onKeyDown ({ code }) {\r\n    if (code === 'ArrowDown') {\r\n      this.activeIndex++\r\n      if (this.activeIndex === this.props.options.length) {\r\n        this.activeIndex = 0\r\n      }\r\n      this.props.onChange && this.props.onChange(this.activeIndex, this.props.options[this.activeIndex])\r\n    } else if (code === 'ArrowUp') {\r\n      this.activeIndex--\r\n      if (this.activeIndex === -1) {\r\n        this.activeIndex += this.props.options.length\r\n      }\r\n      this.props.onChange && this.props.onChange(this.activeIndex, this.props.options[this.activeIndex])\r\n    } else if (code === 'Space') {\r\n      this.props.onConfirm && this.props.onConfirm(this.activeIndex, this.props.options[this.activeIndex])\r\n    } else if (code === 'Escape') {\r\n      this.props.onClose && this.props.onClose()\r\n    }\r\n  }\r\n\r\n  onClick (index) {\r\n    this.activeIndex = index\r\n    this.props.onConfirm && this.props.onConfirm(this.activeIndex, this.props.options[this.activeIndex])\r\n  }\r\n\r\n  render () {\r\n    const size = 32\r\n    const borderWidth = 2\r\n    const select = this.styles.select\r\n    const { width } = select\r\n\r\n    return (\r\n      <div style={this.styles.select}>\r\n        {\r\n          this.props.options && this.props.options.length\r\n            ? this.props.options.map((item, index) => {\r\n              const { text } = item\r\n              const optionStyle = {\r\n                y: index * size,\r\n                height: size,\r\n                width: width,\r\n                borderWidth: this.activeIndex === index ? borderWidth : 0,\r\n                borderColor: '#ccc',\r\n              }\r\n              return (\r\n                <div style={optionStyle} onClick={() => this.onClick(index)} onMouseLeave={(e) => { this.activeIndex = -1 }} onMouseEnter={(e) => { this.activeIndex = index }}>\r\n                  {text}\r\n                </div>\r\n              )\r\n            })\r\n            : '空空如也'}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","export function setStorage (key, value) {\r\n  return localStorage.setItem(key, JSON.stringify(value))\r\n}\r\n\r\nexport function getStorage (key) {\r\n  try {\r\n    return JSON.parse(localStorage.getItem(key))\r\n  } catch (e) {\r\n    return null\r\n  }\r\n}\r\n","import { setStorage, getStorage } from 'Engine/utils/storage'\r\n\r\nexport function saveGame (saveData) {\r\n  return setStorage('game', saveData)\r\n}\r\n\r\nexport function loadGame () {\r\n  return getStorage('game')\r\n}\r\n","import { Component } from 'Engine'\r\nimport Select from './Select'\r\nimport { loadGame } from '../sl'\r\n\r\nexport default class Title extends Component {\r\n  styles = {\r\n    title: {\r\n      width: 32 * (13 + 5),\r\n      height: 32 * 13,\r\n    },\r\n    gameName: {\r\n      y: 40,\r\n      width: 32 * (13 + 5),\r\n      height: 128,\r\n      font: 'bold 128px 黑体',\r\n    },\r\n    select: {\r\n      x: 16 * 16,\r\n      y: 32 * 8,\r\n      width: 64,\r\n    },\r\n  }\r\n\r\n  create () {\r\n    this.activeIndex = loadGame() ? 1 : 0\r\n    this.options = [\r\n      {\r\n        text: '开始',\r\n      },\r\n      {\r\n        text: '继续',\r\n      },\r\n    ]\r\n  }\r\n\r\n  onConfirm = (isLoad) => {\r\n    this.props.onLoadMap(isLoad ? loadGame() : null)\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div style={this.styles.title}>\r\n        <div style={this.styles.gameName}>魔塔</div>\r\n        <Select activeIndex={this.activeIndex} options={this.options} style={this.styles.select} onConfirm={this.onConfirm}></Select>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'Engine'\r\nimport { loadGame, saveGame } from '../sl'\r\nimport Select from './Select'\r\nconst options = [\r\n  { text: '物品' },\r\n  { text: '技能' },\r\n  { text: '装备' },\r\n  { text: '状态' },\r\n]\r\n\r\nconst itemOption = []\r\nconst statusOption = []\r\nconst loadGameOption = [{ text: 12233 }]\r\nconst saveGameOption = [{ text: 1 }, { text: 2 }, { text: 3 }, { text: 4 }]\r\n\r\nconst detailOption = [itemOption, statusOption, itemOption, itemOption, loadGameOption, saveGameOption]\r\nexport default class Menu extends Component {\r\n  activeIndex = -1\r\n  tick = 0\r\n  create () {\r\n    this.styles = {\r\n      menu: {\r\n        width: 32 * 18,\r\n        height: 32 * 13,\r\n        backgroundColor: 'rgba(0,0,0,.6)',\r\n      },\r\n      detail: {\r\n        x: 32 * 4,\r\n        width: 32 * 9,\r\n        height: 32 * 13,\r\n        borderWidth: 2,\r\n      },\r\n      select: {\r\n        width: 32 * 4,\r\n      },\r\n    }\r\n  }\r\n\r\n  onConfirm = (activeIndex) => {\r\n    this.activeIndex = activeIndex\r\n  }\r\n\r\n  render () {\r\n    return <div style={this.styles.menu}>\r\n      <Select options={options} style={this.styles.select} onConfirm={this.onConfirm} onClose={this.props.onClose} />\r\n\r\n      {\r\n        this.activeIndex === -1\r\n          ? null\r\n          : <Select options={detailOption[this.activeIndex]} style={this.styles.detail} onConfirm={this.onConfirm} onClose={() => { this.activeIndex = -1 }} />\r\n      }\r\n    </div>\r\n  }\r\n}\r\n","import { Component } from 'Engine'\r\nimport Select from './Select'\r\nexport default class Shop extends Component {\r\n  styles = {\r\n    shop: {\r\n      x: 2 * 32,\r\n      y: 2 * 32,\r\n      height: 32 * 7,\r\n      width: 32 * 9,\r\n\r\n      fontSize: 24,\r\n      borderWidth: 4,\r\n      borderColor: '#deb887',\r\n      textAlign: 'center',\r\n      backgroundImage: 'ground.png',\r\n    },\r\n    title: {\r\n      x: 16 * 9,\r\n      y: 16,\r\n    },\r\n    text: {\r\n      x: 0,\r\n      y: 48,\r\n      fontSize: 14,\r\n    },\r\n    select: {\r\n      x: 32 * 2,\r\n      y: 112,\r\n      width: 32 * 5,\r\n      fontSize: 16,\r\n    },\r\n  }\r\n\r\n  create () {\r\n    this.shop = window.$res.shop[this.props.shopid]\r\n  }\r\n\r\n  onConfirm = (index) => {\r\n    const { need, effect } = this.shop.choices[index]\r\n    this.props.onShopEvent(need, effect)\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div style={this.styles.shop}>\r\n        <div style={this.styles.title}>{this.shop.title}</div>\r\n        <div style={this.styles.text}>\r\n          {this.shop.text.split(/\\n/).map((text, index) => <div style={{ x: 16 * 9, y: index * 16 }}>{text}</div>)}\r\n        </div>\r\n        <Select options={this.shop.choices} onConfirm={this.onConfirm} style={this.styles.select} onClose={this.props.onClose}></Select>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { Component, KeyEventComponent } from 'Engine'\r\n\r\nexport default class Battle extends KeyEventComponent {\r\n  tick = 0\r\n  styles = {\r\n    battle: {\r\n      x: 48,\r\n      y: 48,\r\n      width: 32 * 15,\r\n      height: 32 * 10,\r\n      fontSize: 16,\r\n      borderWidth: 3,\r\n      borderColor: '#deb887',\r\n      font: '32px sans-serif',\r\n      swidth: 640,\r\n      sheight: 320,\r\n    },\r\n    enemy: {\r\n      x: 32 * 1,\r\n      y: 32 * 1,\r\n    },\r\n    hero: {\r\n      x: 32 * 10,\r\n      y: 32 * 1,\r\n    },\r\n  }\r\n\r\n  create () {\r\n    this.enemy = JSON.parse(JSON.stringify(this.props.enemy))\r\n    this.hero = this.props.hero\r\n  }\r\n\r\n  onKeyDown () {\r\n    if (this.battleMsg) {\r\n      this.props.onClose && this.props.onClose()\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const enemy = this.enemy\r\n    const hero = this.hero\r\n    const tick = location.hostname === 'localhost' ? 1 : 5\r\n    if (enemy.hp > 0) {\r\n      this.tick++\r\n      if (this.tick === tick) {\r\n        window.$sound.play('se', 'attack.mp3')\r\n\r\n        if (this.turn) {\r\n          const atk = enemy.atk - hero.def\r\n          if (atk > 0) {\r\n            hero.hp -= atk\r\n          }\r\n        } else {\r\n          const atk = hero.atk - enemy.def\r\n          if (atk > 0) {\r\n            enemy.hp -= atk\r\n          }\r\n          if (enemy.hp <= 0) {\r\n            enemy.hp = 0\r\n            const { exp, money } = enemy\r\n            hero.exp += exp\r\n            this.props.saveData.money += money\r\n            this.battleMsg = `战斗胜利，获得${money}金币，${exp}经验`\r\n          }\r\n        }\r\n        this.turn = !this.turn\r\n        this.tick = 0\r\n      }\r\n    }\r\n\r\n    const proprety = [{ text: '名称', key: 'name' }, { text: '生命', key: 'hp' }, { text: '攻击', key: 'atk' }, { text: '防御', key: 'def' }]\r\n    const heroImageStyle = { x: 32, y: 32 * 4.5, swidth: 32, sheight: 32, width: 64, height: 64, sy: 0 }\r\n    const enemyImageStyle = { x: 32, y: 32 * 4.5, swidth: 32, sheight: 32, width: 64, height: 64, sy: enemy.sy * 32 }\r\n    const size = 64\r\n    const vsStyle = { font: `bold ${size}px sans-serif`, x: 32 * (5 + 1.5), y: 32 * 2, height: size, width: size }\r\n    const msgStyle = { fontSize: 24, height: 32, y: 32 * 8, width: 32 * 15 }\r\n    return <img src=\"Battlebacks/mota.jpg\" style={this.styles.battle}>\r\n      {this.battleMsg && <div style={msgStyle}>{this.battleMsg}</div>}\r\n      <div style={this.styles.enemy}>\r\n        <img src=\"enemys.png\" style={enemyImageStyle} />\r\n        {proprety.map((item, index) => {\r\n          return <div style={{ x: 0 * 32, y: index * 32 }}>\r\n            <div style={{ width: 32 * 4, textAlign: 'left', height: 32 }}>{item.text}</div>\r\n            <div style={{ width: 32 * 4, textAlign: 'right', height: 32 }}>{enemy[item.key]}</div>\r\n          </div>\r\n        })}\r\n      </div>\r\n      <div style={vsStyle}>VS</div>\r\n      <div style={this.styles.hero}>\r\n        <img src=\"Characters/hero.png\" style={heroImageStyle} />\r\n        {proprety.map((item, index) => {\r\n          return <div style={{ x: 0 * 32, y: index * 32 }}>\r\n            <div style={{ width: 32 * 4, textAlign: 'left', height: 32 }}>{hero[item.key]}</div>\r\n            <div style={{ width: 32 * 4, textAlign: 'right', height: 32 }}>{item.text}</div>\r\n          </div>\r\n        })}\r\n      </div>\r\n    </img>\r\n  }\r\n}\r\n","import { Component, KeyEventComponent } from 'Engine'\r\n\r\nexport default class Talk extends KeyEventComponent {\r\n  index = 0\r\n  width = 7\r\n  styles = {\r\n    talk: {\r\n      width: 32 * this.width,\r\n      height: 32 * 1,\r\n      backgroundColor: 'black',\r\n      borderWidth: 2,\r\n      borderColor: 'white',\r\n      fontSize: 16,\r\n      textAlign: 'left',\r\n      textBaseline: 'middle',\r\n    },\r\n  }\r\n\r\n  onKeyDown ({ code }) {\r\n    if (code === 'Space') {\r\n      this.index++\r\n      if (this.index === this.props.talk.length) {\r\n        this.props.onConfirm()\r\n      } else {\r\n        this.next()\r\n      }\r\n    }\r\n    window.$sound.play('se', 'dialogue.mp3')\r\n  }\r\n\r\n  next () {\r\n    const talks = this.props.talk[this.index].split(/\\n/)\r\n    this.current = []\r\n    talks.forEach((talk) => {\r\n      for (let i = 0; i < talk.length; i = i + 7 * 2) {\r\n        this.current.push(talk.substr(i, 7 * 2))\r\n      }\r\n    })\r\n\r\n    const leftStyle = {\r\n      x: 32 * 2,\r\n      y: 32 * 2,\r\n      height: 32 * this.current.length,\r\n    }\r\n    const rightStyle = {\r\n      x: 32 * 4,\r\n      y: 32 * 6,\r\n      height: 32 * this.current.length,\r\n    }\r\n    this.turn = !this.turn\r\n    Object.assign(this.styles.talk, this.turn ? leftStyle : rightStyle)\r\n  }\r\n\r\n  create () {\r\n    this.next()\r\n  }\r\n\r\n  render () {\r\n    return <div style={this.styles.talk}>\r\n      {this.current.map((talk, index) => {\r\n        return <div style={{ x: 0, y: 32 * index, width: 32 * this.width, height: 32 }}>{talk}</div>\r\n      })}\r\n    </div>\r\n  }\r\n}\r\n","export function calcLength (str) {\r\n  let len = 0\r\n  for (let i = 0; i < str.length; i++) {\r\n    if (str.charCodeAt(i) > 127) {\r\n      len += 2\r\n    } else {\r\n      len += 1\r\n    }\r\n  }\r\n  return len\r\n}\r\n\r\nexport function splitStringByWidth (str, w) {\r\n  let len = 0\r\n  let start = 0\r\n  const re = []\r\n  let i = 0\r\n  for (; i < str.length; i++) {\r\n    let c = 0\r\n    if (str.charCodeAt(i) > 127) {\r\n      c = 2\r\n    } else {\r\n      c = 1\r\n    }\r\n    len += c\r\n    if (len > w) {\r\n      re.push(str.substring(start, i))\r\n      start = i\r\n      len = c\r\n    }\r\n  }\r\n  re.push(str.substring(start, i))\r\n  return re\r\n}\r\n","import { Component } from 'Engine'\r\nimport { calcLength } from '../../Engine/utils/string'\r\n\r\nexport default class Message extends Component {\r\n  create () {\r\n    if (this.props) {\r\n      this.tick = this.props.tick || 120\r\n    }\r\n    this.length = calcLength(this.props.msg)\r\n    this.msg = this.props.msg\r\n  }\r\n\r\n  render () {\r\n    this.tick--\r\n    if (this.tick === 0) {\r\n      this.props.onMessageClose()\r\n      return null\r\n    }\r\n    let globalAlpha = 1\r\n    if (this.tick < 30) {\r\n      globalAlpha = this.tick / 30\r\n    }\r\n    const fontSize = 18\r\n    const style = { textAlign: 'left', fontSize, backgroundColor: 'rgba(0,0,0,.7)', globalAlpha, x: 0, y: 0, height: 32, width: fontSize / 2 * this.length + 10 }\r\n    return <div style={style}>\r\n      <div style={{ x: 5, height: 32 }}>{this.msg}</div>\r\n    </div>\r\n  }\r\n}\r\n","import { KeyEventComponent } from 'Engine'\r\n\r\nexport default class EnemyInfo extends KeyEventComponent {\r\n  onKeyDown ({ code }) {\r\n    if (code === 'KeyX') {\r\n      this.props.onClose()\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const enemys = Object.keys(this.props.enemys)\r\n    return (\r\n      <div\r\n        style={{\r\n          textAlign: 'left',\r\n          fontSize: 16,\r\n          backgroundColor: 'rgba(0,0,0,.8)',\r\n          width: 32 * 18,\r\n          height: 32 * 13,\r\n        }}\r\n      >\r\n        <div style={{ x: 32, y: 32 }}>\r\n          <div style={{ x: 32 * 1, height: 32 }}>名字</div>\r\n          <div style={{ x: 32 * 4, height: 32 }}>生命</div>\r\n          <div style={{ x: 32 * 6, height: 32 }}>攻击</div>\r\n          <div style={{ x: 32 * 8, height: 32 }}>防御</div>\r\n          <div style={{ x: 32 * 10, height: 32 }}>损失</div>\r\n          {enemys.map((enemyId, index) => {\r\n            const style = {\r\n              x: 0,\r\n              y: index * 32 + 32,\r\n              height: 32,\r\n            }\r\n            const enemy = window.$res.enemys[enemyId]\r\n            const hero = this.props.saveData.hero\r\n            let cost = 0\r\n            if (hero.atk > enemy.def) {\r\n              if (\r\n                hero.def >= enemy.atk ||\r\n                enemy.hp / (hero.atk - enemy.def) <=\r\n                  hero.hp / (enemy.atk - hero.def)\r\n              ) {\r\n                if (hero.def >= enemy.atk) {\r\n                  cost = 0\r\n                } else {\r\n                  const atkCount = Math.floor(\r\n                    enemy.hp / (hero.atk - enemy.def),\r\n                  )\r\n                  cost = (enemy.atk - hero.def) * atkCount\r\n                }\r\n              } else {\r\n                cost = '-'\r\n              }\r\n            } else {\r\n              cost = '-'\r\n            }\r\n            return (\r\n              <div style={style}>\r\n                <img src=\"enemys.png\" alt=\"\" style={{ height: 32, width: 32, sy: enemy.sy * 32 }}/>\r\n                <div style={{ x: 32 * 1, height: 32 }}>{enemy.name}</div>\r\n                <div style={{ x: 32 * 4, height: 32 }}>{enemy.hp}</div>\r\n                <div style={{ x: 32 * 6, height: 32 }}>{enemy.atk}</div>\r\n                <div style={{ x: 32 * 8, height: 32 }}>{enemy.def}</div>\r\n                <div style={{ x: 32 * 10, height: 32 }}>{cost}</div>\r\n              </div>\r\n            )\r\n          })}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'Engine'\r\nimport Select from './Select'\r\nexport default class ShopList extends Component {\r\n  style = {\r\n    x: 32 * 3,\r\n    y: 32 * 2,\r\n    height: 32 * 8,\r\n    width: 32 * 7,\r\n    backgroundImage: 'ground.png',\r\n    borderWidth: 4,\r\n    borderColor: '#deb887',\r\n  }\r\n\r\n  create () {\r\n    const shops = this.props.saveData.shops || []\r\n    this.options = Object.entries(shops).map(([shopid, text]) => {\r\n      return { text, shopid }\r\n    })\r\n  }\r\n\r\n  onConfirm = (index) => {\r\n    const { shopid } = this.options[index]\r\n    this.props.onConfirm(shopid)\r\n  }\r\n\r\n  render () {\r\n    return (\r\n      <div style={this.style}>\r\n        <div style={{ height: 32, width: 32 * 7, fontSize: 24 }}>商店选择</div>\r\n        <Select style={{ x: 32, y: 48, width: 160 }} options={this.options} onConfirm={this.onConfirm} onClose={this.props.onClose}/>\r\n      </div>\r\n\r\n    )\r\n  }\r\n}\r\n","export function isCoincided (A, B) {\r\n  if (\r\n    A.x >= B.x + B.width ||\r\n    A.x + A.width <= B.x ||\r\n    A.y >= B.y + B.height ||\r\n    A.y + A.height <= B.y\r\n  ) {\r\n    return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport function updateVector (vector, obj) {\r\n  vector = Object.assign(Object.create(null), vector)\r\n  Object.entries(obj).forEach(([key, value]) => {\r\n    vector[key] += value\r\n  })\r\n  return vector\r\n}\r\n\r\nexport function assignVector (vector, obj) {\r\n  return Object.assign(vector, obj)\r\n}\r\n","export function convertPropertyStr (str) {\r\n  const arr = str.split('.')\r\n  if (arr.length === 1) {\r\n    arr.unshift('')\r\n  }\r\n  const [key, propertyStr] = arr\r\n  const properties = propertyStr.split(';').map(v => v.split(':'))\r\n  return [key, properties]\r\n}\r\n\r\nexport const formatText = (data) => {\r\n  const o = []\r\n  data = data.split(/\\r?\\n/)\r\n  const keys = data.shift().split(',')\r\n  data.forEach((row, index) => {\r\n    if (!row.trim()) {\r\n      return\r\n    }\r\n    const properties = row.split(',')\r\n    const [id] = properties\r\n    const item = { sy: index }\r\n    keys.forEach((key, index) => {\r\n      const value = properties[index]\r\n      if (!value) {\r\n        return\r\n      }\r\n      if (key === 'property') {\r\n        item[key] = convertPropertyStr(value)\r\n      } else if (['id', 'name', 'type'].includes(key)) {\r\n        item[key] = value\r\n      } else {\r\n        item[key] = isNaN(value) ? value : Number(value)\r\n      }\r\n    })\r\n    o[id] = item\r\n    o.push(item)\r\n    return data\r\n  })\r\n  return o\r\n}\r\n","import { KeyEventComponent } from 'Engine'\r\n\r\nimport Menu from './Menu'\r\nimport Shop from './Shop'\r\nimport Battle from './Battle'\r\nimport Talks from './Talks'\r\nimport Message from './Message'\r\nimport EnemyInfo from './EnemyInfo'\r\nimport ShopList from './ShopList'\r\n\r\nimport { saveGame, loadGame } from '../sl'\r\nimport { isCoincided, updateVector, assignVector } from '../physics'\r\nimport { convertPropertyStr } from '../utils'\r\n\r\nconst propertyNames = {\r\n  lv: '等级',\r\n  money: '金币',\r\n  hp: '生命',\r\n  atk: '攻击',\r\n  def: '防御',\r\n  exp: '经验',\r\n}\r\nexport default class Hero extends KeyEventComponent {\r\n  tick = 0;\r\n  create () {\r\n    const hero = Object.assign(this.props.saveData.position, {\r\n      width: 32,\r\n      height: 32,\r\n    })\r\n\r\n    this.styles = { hero }\r\n  }\r\n\r\n  isCoincidedTerrains (heroStyle) {\r\n    return this.props.mapTerrains.findIndex(\r\n      (item) => item && item && isCoincided(item.props.style, heroStyle),\r\n    )\r\n  }\r\n\r\n  isCoincidedEvents (heroStyle) {\r\n    return this.props.mapEvents.findIndex(\r\n      (item) => item && item && isCoincided(item.props.style, heroStyle),\r\n    )\r\n  }\r\n\r\n  onKeyDown (e) {\r\n    const { code } = e\r\n    const styleHero = this.styles.hero\r\n    const step = 32\r\n    let moveVector = null\r\n    if (code === 'ArrowDown') {\r\n      moveVector = { y: step }\r\n      styleHero.sy = 0\r\n    } else if (code === 'ArrowUp') {\r\n      moveVector = { y: -step }\r\n      styleHero.sy = 96\r\n    } else if (code === 'ArrowLeft') {\r\n      moveVector = { x: -step }\r\n      styleHero.sy = 32\r\n    } else if (code === 'ArrowRight') {\r\n      moveVector = { x: step }\r\n      styleHero.sy = 64\r\n    } else if (code === 'KeyS') {\r\n      saveGame(this.props.saveData)\r\n      this.msg = '存储成功'\r\n    } else if (code === 'KeyL') {\r\n      this.props.onLoadMap(loadGame())\r\n    } else if (code === 'KeyX') {\r\n      this.showEnemyInfo = !this.showEnemyInfo\r\n    } else if (code === 'KeyB') {\r\n      this.buying = true\r\n    } else if (code === 'PageUp') {\r\n      console.log(this.props)\r\n    } else if (code === 'PageUp') {\r\n      console.log(this.props)\r\n    }\r\n    if (moveVector) {\r\n      const vector = updateVector(styleHero, moveVector)\r\n\r\n      const terrain = this.isCoincidedTerrains(vector)\r\n      if (terrain !== -1) {\r\n        return\r\n      }\r\n\r\n      const eventIndex = this.isCoincidedEvents(vector)\r\n      if (eventIndex !== -1) {\r\n        if (this.handleEvents(this.props.map.mapEvents[eventIndex])) {\r\n          assignVector(styleHero, vector)\r\n        }\r\n        return\r\n      }\r\n\r\n      assignVector(styleHero, vector)\r\n    }\r\n  }\r\n\r\n  onShopClose = () => {\r\n    this.shopid = null\r\n    this.setEvent()\r\n  };\r\n\r\n  handleEvents (mapEvent) {\r\n    if (this.mapEvent) {\r\n      return\r\n    }\r\n\r\n    if (mapEvent[3]) {\r\n      this.mapEvent = mapEvent\r\n      this.eventIndex = 0\r\n      this.setEvent()\r\n    } else {\r\n      const info = window.$res.mapping[mapEvent[2]]\r\n      const { name, type } = info\r\n      if (type === 'items') {\r\n        const item = window.$res.items[name]\r\n        const { type } = item\r\n        if (type === '1' || type === '3') {\r\n          this.remove(mapEvent)\r\n          this.updateSaveData('items', name)\r\n          this.msg = `获得${item.name}`\r\n          window.$sound.play('se', type === '1' ? 'item.mp3' : 'constants.mp3')\r\n        } else if (type === '2') {\r\n          this.remove(mapEvent)\r\n          this.updateSaveData(...item.property)\r\n          const [name, property] = item.property\r\n          this.msg = `获得${item.name}`\r\n          property.forEach((property) => {\r\n            const [key, value] = property\r\n            let propertyName = key\r\n            if (name === 'hero') {\r\n              propertyName = propertyNames[key]\r\n            } else if (name === 'items') {\r\n              propertyName = window.$res.items[key].name\r\n            } else if (key === 'money') {\r\n              propertyName = '金币'\r\n            }\r\n            this.msg += ` ${propertyName}${value > 0 ? '+' : '-'}${value}`\r\n          })\r\n          window.$sound.play('se', 'item.mp3')\r\n        }\r\n        return true\r\n      } else if (type === 'enemys') {\r\n        mapEvent[3] = [\r\n          {\r\n            type: 'enemy',\r\n            data: name,\r\n          },\r\n        ]\r\n        this.handleEvents(mapEvent)\r\n        return false\r\n      } else if (type === 'terrains') {\r\n        if (\r\n          [\r\n            'yellowDoor',\r\n            'redDoor',\r\n            'blueDoor',\r\n            'steelDoor',\r\n            'specialDoor',\r\n          ].includes(name)\r\n        ) {\r\n          const key = name.slice(0, -4) + 'Key'\r\n          if (this.props.saveData.items[key]) {\r\n            this.props.saveData.items[key]--\r\n            this.remove(mapEvent)\r\n            window.$sound.play('se', 'door.mp3')\r\n            return true\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setEvent = () => {\r\n    if (this.eventIndex < this.mapEvent[3].length) {\r\n      const event = this.mapEvent[3][this.eventIndex++]\r\n      const { type, data } = event\r\n      if (type === 'talk') {\r\n        this.talk = data\r\n        return\r\n      } else if (type === 'mapLoad') {\r\n        this.props.onLoadMap(data)\r\n      } else if (type === 'openShop') {\r\n        this.shopid = event.id\r\n        this.props.saveData.shops = this.props.saveData.shops || {}\r\n        this.props.saveData.shops[this.shopid] =\r\n          window.$res.shop[this.shopid].title\r\n        return\r\n      } else if (type === 'getItems') {\r\n        this.updateSaveData('items', data)\r\n      } else if (type === 'removeSelf') {\r\n        this.remove(this.mapEvent)\r\n        return\r\n      } else if (type === 'moveBlock') {\r\n        console.log(this.mapEvent)\r\n        this.remove(this.mapEvent)\r\n        return\r\n      } else if (type === 'enemy') {\r\n        const enemy = window.$res.enemys[data]\r\n        const hero = this.props.saveData.hero\r\n        if (hero.atk > enemy.def) {\r\n          if (\r\n            hero.def >= enemy.atk ||\r\n            enemy.hp / (hero.atk - enemy.def) <=\r\n              hero.hp / (enemy.atk - hero.def)\r\n          ) {\r\n            this.enemy = enemy\r\n            return\r\n          } else {\r\n            this.mapEvent = null\r\n            this.eventIndex = 0\r\n            this.msg = `你打不过${enemy.name}`\r\n            return\r\n          }\r\n        } else {\r\n          this.mapEvent = null\r\n          this.eventIndex = 0\r\n          this.msg = `你的攻击比${enemy.name}的防御低`\r\n          return\r\n        }\r\n      } else if (type === 'updateSaveData') {\r\n        this.updateSaveData(...convertPropertyStr(data))\r\n      } else if (type === 'removeBlock') {\r\n        this.props.removeMapEvent(data)\r\n      } else if (type === 'title') {\r\n        this.props.onTitle()\r\n      } else if (type === 'removeMapBlock') {\r\n        const { mapId, position } = data\r\n        const { x, y } = position\r\n        this.props.saveData.destroy[[mapId, x, y]] = true\r\n      } else if (type === 'if') {\r\n        const { condition, true: trueEvent, false: falseEvent } = event\r\n        this.mapEvent = null\r\n        this.eventIndex = 0\r\n        if (this.checkSaveData(...convertPropertyStr(condition))) {\r\n          this.mapEvent = [0, 0, 0, trueEvent]\r\n        } else {\r\n          this.mapEvent = [0, 0, 0, falseEvent]\r\n        }\r\n      } else {\r\n        console.error(event)\r\n      }\r\n      this.setEvent()\r\n    } else {\r\n      this.mapEvent = null\r\n    }\r\n  };\r\n\r\n  remove (mapEvent) {\r\n    this.props.removeMapEvent(mapEvent)\r\n    this.mapEvent = null\r\n  }\r\n\r\n  onBattleClose = () => {\r\n    this.enemy = null\r\n    this.props.removeMapEvent(this.mapEvent)\r\n    this.setEvent()\r\n  };\r\n\r\n  onConfirm = () => {\r\n    this.talk = null\r\n    this.setEvent()\r\n  };\r\n\r\n  onMenuClose = () => {\r\n    this.showMenu = null\r\n  };\r\n\r\n  onMessageClose = () => {\r\n    this.msg = null\r\n  };\r\n\r\n  updateSaveData (context, gets, n = 1) {\r\n    if (Array.isArray(gets)) {\r\n      gets.forEach(([id, value]) => this.updateSaveData(context, id, value))\r\n    } else if (typeof gets === 'string') {\r\n      const saveData = context\r\n        ? this.props.saveData[context]\r\n        : this.props.saveData\r\n      saveData[gets] = saveData[gets] || 0\r\n      saveData[gets] += Number(n)\r\n    } else if (typeof gets === 'object') {\r\n      this.updateSaveData(context, Object.entries(gets))\r\n    } else {\r\n      console.error(gets, n)\r\n    }\r\n  }\r\n\r\n  checkSaveData (context, gets, n = 1) {\r\n    if (Array.isArray(gets)) {\r\n      return gets.some(([id, value]) => this.checkSaveData(context, id, value))\r\n    } else if (typeof gets === 'string') {\r\n      const saveData = context\r\n        ? this.props.saveData[context]\r\n        : this.props.saveData\r\n      saveData[gets] = saveData[gets] || 0\r\n      return saveData[gets] + Number(n) >= 0\r\n    } else if (typeof gets === 'object') {\r\n      return this.checkSaveData(context, Object.entries(gets), null, 0)\r\n    } else {\r\n      return false\r\n    }\r\n  }\r\n\r\n  onShopEvent = (need, effect) => {\r\n    if (this.checkSaveData(...convertPropertyStr(need))) {\r\n      this.updateSaveData(...convertPropertyStr(need))\r\n      this.updateSaveData(...convertPropertyStr(effect))\r\n    }\r\n  };\r\n\r\n  onShopListClose = () => {\r\n    this.buying = false\r\n  };\r\n\r\n  onShopListConfirm = (shopid) => {\r\n    this.buying = false\r\n    this.shopid = shopid\r\n    this.mapEvent = [0, 0, 0, []]\r\n  };\r\n\r\n  render () {\r\n    return (\r\n      <div>\r\n        <img style={this.styles.hero} src=\"Characters/hero.png\"></img>\r\n        {this.buying && (\r\n          <ShopList\r\n            saveData={this.props.saveData}\r\n            onClose={this.onShopListClose}\r\n            onConfirm={this.onShopListConfirm}\r\n          />\r\n        )}\r\n        {this.shopid && (\r\n          <Shop\r\n            shopid={this.shopid}\r\n            saveData={this.props.saveData}\r\n            onClose={this.onShopClose}\r\n            onShopEvent={this.onShopEvent}\r\n          />\r\n        )}\r\n        {this.enemy && (\r\n          <Battle\r\n            enemy={this.enemy}\r\n            enemyId={this.enemyId}\r\n            hero={this.props.saveData.hero}\r\n            saveData={this.props.saveData}\r\n            onClose={this.onBattleClose}\r\n          />\r\n        )}\r\n        {this.showMenu && (\r\n          <Menu saveData={this.props.saveData} onClose={this.onMenuClose} />\r\n        )}\r\n        {this.talk && (\r\n          <Talks talk={this.talk} key={this.talk} onConfirm={this.onConfirm} />\r\n        )}\r\n        {this.msg && (\r\n          <Message\r\n            msg={this.msg}\r\n            key={this.msg}\r\n            onMessageClose={this.onMessageClose}\r\n          />\r\n        )}\r\n        {this.showEnemyInfo && (\r\n          <EnemyInfo\r\n            enemys={this.props.enemys}\r\n            saveData={this.props.saveData}\r\n            onClose={() => (this.showEnemyInfo = false)}\r\n          />\r\n        )}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","\r\nimport { Component } from 'Engine'\r\n\r\nexport default class Status extends Component {\r\n  create () {\r\n    this.walls = []\r\n    for (let x = 0; x < 5; x++) {\r\n      for (let y = 0; y < 13; y++) {\r\n        if (x === 4 || y === 0 || y === 12) {\r\n          this.walls.push(<img src=\"terrains.png\" style={{ sx: 0, sy: 32 * 2, x: x * 32, y: y * 32, width: 32, height: 32 }}></img>)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const { saveData, map } = this.props\r\n    const rowProperty = [\r\n      window.$res.game.title,\r\n      map.name,\r\n      saveData.hero.lv,\r\n      saveData.hero.hp,\r\n      saveData.hero.atk,\r\n      saveData.hero.def,\r\n      saveData.hero.exp,\r\n      saveData.money,\r\n      saveData.items.yellowKey,\r\n      saveData.items.blueKey,\r\n      saveData.items.redKey,\r\n    ]\r\n    return (\r\n      <div style={{ fontSize: 24 }}>\r\n        {this.walls}\r\n        {rowProperty.map((value, index) => {\r\n          return <div style={{ y: (index + 1) * 32, width: 32, height: 32 }}>\r\n            <img src=\"icons.png\" style={{ sy: index * 32, width: 32, height: 32, swidth: 32, sheight: 32 }} />\r\n            <div style={{ x: 32, height: 32, width: 32 * 3 }}>{value}</div>\r\n          </div>\r\n        })}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { Component } from 'Engine'\r\nimport Hero from './Hero'\r\nimport Status from './Status'\r\nexport default class Map extends Component {\r\n  tick = 0;\r\n  interval = 10;\r\n  styles = {\r\n    map: {\r\n      height: 32 * 13,\r\n      width: 32 * 13,\r\n      backgroundImage: 'ground.png',\r\n    },\r\n    statusBar: {\r\n      x: 32 * 13,\r\n      y: 0,\r\n      backgroundImage: 'ground.png',\r\n      width: 32 * 5,\r\n      height: 13 * 32,\r\n    },\r\n  };\r\n\r\n  create () {\r\n    const bgm = this.props.map.bgm\r\n    window.$sound.play('bgm', bgm)\r\n  }\r\n\r\n  destroy () {\r\n    const bgm = this.props.map.bgm\r\n    window.$sound.pause('bgm', bgm)\r\n  }\r\n\r\n  renderMapTerrains (status) {\r\n    const { mapTerrains } = this.props.map\r\n    const tick = this.tick\r\n    const terrains = []\r\n    if (!mapTerrains) {\r\n      return\r\n    }\r\n    mapTerrains.forEach((line, y) => {\r\n      line.forEach((value, x) => {\r\n        if (value) {\r\n          const info = window.$res.mapping[value]\r\n          const { type, name } = info\r\n          const detail = window.$res[type][name]\r\n          let sx = 0\r\n          if (info.type === 'animates') {\r\n            sx = (tick % 4) * 32\r\n          }\r\n          const style = {\r\n            sy: detail.sy * 32,\r\n            sx,\r\n            x: x * 32,\r\n            y: y * 32,\r\n            height: 32,\r\n            width: 32,\r\n          }\r\n          terrains.push(<img src={type + '.png'} style={style} />)\r\n        } else {\r\n          return null\r\n        }\r\n      })\r\n    })\r\n    return terrains\r\n  }\r\n\r\n  renderMapEvents () {\r\n    const { mapId, destroy = {} } = this.props.saveData\r\n    const { mapEvents } = this.props.map\r\n    const tick = this.tick\r\n    const enemys = {}\r\n    this.enemys = enemys\r\n    if (mapEvents) {\r\n      return mapEvents.map((event) => {\r\n        const [x, y, value, events] = event\r\n        if (value) {\r\n          const info = window.$res.mapping[value]\r\n          if (info) {\r\n            const { type, name } = info\r\n            const detail = window.$res[type][name]\r\n            let sx = 0\r\n            if (type === 'npcs' || type === 'enemys') {\r\n              sx = (tick % 2) * 32\r\n            }\r\n            // terrians items icons npcs enemys\r\n            if (destroy[[mapId, x, y]]) {\r\n              return null\r\n            }\r\n            if (type === 'enemys') {\r\n              enemys[name] = name\r\n            }\r\n            return (\r\n              <div style={{ x: x * 32, y: y * 32, height: 32, width: 32 }}>\r\n                <img\r\n                  src={type + '.png'}\r\n                  style={{ sy: detail.sy * 32, sx, height: 32, width: 32 }}\r\n                />\r\n              </div>\r\n            )\r\n          }\r\n        }\r\n        return null\r\n      })\r\n    }\r\n  }\r\n\r\n  onRemoveMapEvent = (mapEvent) => {\r\n    const [x, y] = mapEvent\r\n    const mapId = this.props.saveData.mapId\r\n    this.props.saveData.destroy = this.props.saveData.destroy || {}\r\n    this.props.saveData.destroy[[mapId, x, y]] = 1\r\n  };\r\n\r\n  onTitle = () => {\r\n    this.props.onTitle()\r\n  };\r\n\r\n  onClick = (e) => {\r\n    console.log(e)\r\n    // DFS BFS\r\n  };\r\n\r\n  render () {\r\n    this.interval--\r\n    if (this.interval === 0) {\r\n      this.tick++\r\n      this.interval = 10\r\n    }\r\n    const mapTerrains = this.renderMapTerrains()\r\n    const mapEvents = this.renderMapEvents()\r\n    return (\r\n      <div>\r\n        <div style={this.styles.map} onClick={this.onClick}>\r\n          {mapTerrains}\r\n          {mapEvents}\r\n        </div>\r\n        <div style={this.styles.statusBar}>\r\n          <Status saveData={this.props.saveData} map={this.props.map} />\r\n        </div>\r\n        <Hero\r\n          mapTerrains={mapTerrains}\r\n          mapEvents={mapEvents}\r\n          saveData={this.props.saveData}\r\n          enemys={this.enemys}\r\n          map={this.props.map}\r\n          onLoadMap={this.props.onLoadMap}\r\n          removeMapEvent={this.onRemoveMapEvent}\r\n          onTitle={this.onTitle}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { KeyEventComponent } from 'Engine'\r\n\r\nexport default class ScrollText extends KeyEventComponent {\r\n  styles = {\r\n    text: {\r\n      fontSize: 20,\r\n      textAlign: 'left',\r\n      textBaseline: 'top',\r\n      x: 0,\r\n      y: 0,\r\n      width: 32 * 18,\r\n      height: 32 * 13,\r\n    },\r\n    scroll: {\r\n      x: 32,\r\n      y: 32 * 5,\r\n    },\r\n  };\r\n\r\n  create () {\r\n    const { text, bgm } = this.props.map\r\n    this.text = text.split('\\n')\r\n    window.$sound.play('bgm', bgm)\r\n  }\r\n\r\n  destroy () {\r\n    const bgm = this.props.map.bgm\r\n    window.$sound.pause('bgm', bgm)\r\n  }\r\n\r\n  onKeyDown ({ code }) {\r\n    if (code === 'Space') {\r\n      this.onClick()\r\n    }\r\n  }\r\n\r\n  onClick = () => {\r\n    if (this.ready) {\r\n      const { type, data } = this.props.map.event\r\n      if (type === 'mapLoad') {\r\n        this.props.onClose(data)\r\n      } else if (type === 'title') {\r\n        this.props.onTitle(data)\r\n      }\r\n    }\r\n  }\r\n\r\n  render () {\r\n    const size = 32\r\n    const style = this.styles.scroll\r\n    if (style.y > -32 * (this.text.length - 2)) {\r\n      const y = 1\r\n      style.y -= y\r\n    } else {\r\n      this.ready = true\r\n    }\r\n    return (\r\n      <div style={this.styles.text} onClick={this.onClick}>\r\n        <div style={this.styles.scroll}>\r\n          {this.text.map((text, index) => <div style={{ y: index * size }}>{text}</div>)}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n","import { formatText } from './utils'\r\n\r\nexport const loadImage = src => {\r\n  return new Promise(function (resolve, reject) {\r\n    const img = new Image()\r\n    img.addEventListener('load', () => resolve(img))\r\n    img.addEventListener('error', () => reject(img))\r\n    img.src = src\r\n  })\r\n}\r\n\r\nexport const loadSound = src => {\r\n  return new Promise(function (resolve, reject) {\r\n    const audio = new Audio()\r\n    audio.addEventListener('canplay', () => resolve(audio))\r\n    audio.addEventListener('error', () => reject(audio))\r\n    audio.src = src\r\n  })\r\n}\r\n\r\nexport function loadJSON (url) {\r\n  return fetch(url).then(data => data.json())\r\n}\r\n\r\nexport function loadText (url) {\r\n  return fetch(url).then(data => data.text()).then(data => formatText(data))\r\n}\r\n\r\nexport function checkFont (name, size = 16) {\r\n  return document.fonts.check(`${size}px ${name}`)\r\n}\r\n\r\nexport function loadFont ({ name, url }) {\r\n  const fontface = new FontFace(name, `url(\"${url}\")`)\r\n  document.fonts.add(fontface)\r\n  fontface.load()\r\n  return fontface.loaded\r\n}\r\n","import { loadImage, loadSound, loadJSON, loadFont, loadText } from './http'\r\n\r\nconst $res = {\r\n  images: {},\r\n  sounds: {},\r\n}\r\n\r\nwindow.$res = $res\r\n\r\nconst loaderMap = [\r\n  'game.json',\r\n  'save.json',\r\n  'shop.json',\r\n  'mapping.dat',\r\n]\r\n\r\nconst sprite = [\r\n  'enemys',\r\n  'items',\r\n  'animates',\r\n  'icons',\r\n  'npcs',\r\n  'terrains',\r\n  'boss',\r\n]\r\n\r\nconst arr3 = [].concat(loaderMap.map(v => `Data/${v}`), sprite.map(v => `Sprite/${v}.dat`))\r\n\r\nexport const loaderData = () => Promise.all(arr3.map(url => url.endsWith('.dat') ? loadText(`${url}`) : loadJSON(`${url}`)))\r\n  .then(([game, save, shop, mapping, enemys, items, animates, icons, npcs, terrains, boss]) => {\r\n    Object.assign($res, { game, save, shop, mapping, enemys, items, animates, icons, npcs, terrains, boss })\r\n  })\r\n\r\nconst loadImages = () => {\r\n  const o = sprite.map(v => `Sprite/${v}.png`)\r\n  const o2 = ['Characters/hero.png', 'ground.png', 'Battlebacks/mota.jpg'].map(v => `Graph/${v}`)\r\n\r\n  return Promise.all([...o, ...o2].map(src => {\r\n    return new Promise((resolve) => {\r\n      loadImage(`${src}`).then((img) => {\r\n        src = src.replace('Graph/', '')\r\n        if (src.includes('Sprite')) {\r\n          src = src.split('/')[1]\r\n        }\r\n        $res.images[src] = img\r\n        resolve()\r\n      })\r\n    })\r\n  }))\r\n}\r\n\r\nexport const loaderImage = () => Promise.all([loadImages()])\r\nconst sounds = [\r\n  'bgm/terror.mp3',\r\n  'bgm/prologue.mp3',\r\n  'bgm/area1.mp3',\r\n  'bgm/area2.mp3',\r\n  'bgm/area3.mp3',\r\n  'enemy/redWizard.mp3',\r\n  'enemy/brownWizard.mp3',\r\n  'enemy/whiteKing.mp3',\r\n  'enemy/blackMagician.mp3',\r\n  'se/attack.mp3',\r\n  'se/floor.mp3',\r\n  'se/door.mp3',\r\n  'se/buy.mp3',\r\n  'se/item.mp3',\r\n  'se/dialogue.mp3',\r\n  'se/unlockCtrl.mp3',\r\n  'se/step.mp3',\r\n  'se/constants.mp3',\r\n  'se/sell.mp3',\r\n  'se/load.mp3',\r\n]\r\n\r\nexport const loaderMusic = () => Promise.all([\r\n  loadSounds(sounds),\r\n  // loadSounds(sounds.sounds),\r\n])\r\n\r\nexport const loaderFont = (font) => {\r\n  return loadFont(font)\r\n}\r\n\r\nconst loadSounds = data => {\r\n  return Promise.all(data.map(sound => loadSound(`Sound/${sound}`))).then(Soundes => {\r\n    Soundes.forEach((Sound, i) => ($res.sounds[data[i]] = Sound))\r\n  })\r\n}\r\n\r\nexport const loadMap = mapId => {\r\n  return loadJSON(`Maps/${mapId}.json`)\r\n}\r\n","import { Component } from 'Engine'\r\nimport FPS from './Mota/FPS'\r\nimport Loading from './Mota/Loading'\r\nimport Title from './Mota/Title'\r\nimport Map from './Mota/Map'\r\nimport ScrollText from './Mota/ScrollText'\r\nimport { loaderData, loaderMusic, loaderImage, loadMap, loaderFont } from './loader'\r\n\r\nexport default class Game extends Component {\r\n  styles = {\r\n    app: {\r\n      height: 32 * 13,\r\n      width: 32 * 18,\r\n      textAlign: 'center',\r\n      textBaseline: 'middle',\r\n    },\r\n  };\r\n\r\n  async loadFont () {\r\n    this.loading = '加载字体'\r\n    const font = window.$res.game.font\r\n    await loaderFont(font)\r\n    this.styles.app.fontFamily = font.name\r\n  }\r\n\r\n  async create () {\r\n    this.loading = '加载数据'\r\n    await loaderData()\r\n    this.loading = '加载图片'\r\n    await loaderImage()\r\n    this.loading = '加载音乐'\r\n    await loaderMusic()\r\n    this.loading = false\r\n\r\n    this.saveData = window.$res.save\r\n  }\r\n\r\n  onLoadMap = async (data) => {\r\n    this.loading = '加载地图'\r\n    Object.assign(this.saveData, data)\r\n    this.map = await loadMap(this.saveData.mapId)\r\n    this.loading = false\r\n    this.randMapKey = `${this.saveData.mapId} ${new Date()}`\r\n    window.$sound.play('se', 'floor.mp3')\r\n  };\r\n\r\n  onTitle = () => {\r\n    this.map = null\r\n  }\r\n\r\n  render () {\r\n    return <div style={this.styles.app}>\r\n        {\r\n          this.loading\r\n            ? <Loading msg={this.loading} />\r\n            : this.map\r\n              ? this.map.text\r\n                ? <ScrollText map={this.map} onClose={this.onLoadMap} onTitle={this.onTitle}></ScrollText>\r\n                : <Map\r\n                  map={this.map}\r\n                  key={this.randMapKey}\r\n                  onLoadMap={this.onLoadMap}\r\n                  saveData={this.saveData}\r\n                  onEvent={this.onEvent}\r\n                />\r\n              : <Title onLoadMap={this.onLoadMap} />\r\n        }\r\n        <FPS />\r\n      </div>\r\n  }\r\n}\r\n","import Engine from './Engine'\r\nimport Game from './Game'\r\n// eslint-disable-next-line no-new\r\nnew Engine(Game)\r\n"],"names":["createNode","tag","props","children","curFoucs","Component","constructor","$children","$c","argu","KeyEventComponent","$isFocus","$nextFocus","$preFocus","console","warn","destroy","fontFamily","document","fonts","check","baseStyle","direction","color","filter","fontSize","font","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","shadowBlur","shadowColor","shadowOffsetX","shadowOffsetY","strokeStyle","textAlign","textBaseline","isPrimitive","value","type","isFunc","f","isArray","a","Array","isUndefined","o","undefined","getImage","src","window","$res","images","moveEvent","mouseEvents","keyEvents","UI","screen","canvas","createElement","context","getContext","el","width","height","dom","querySelector","body","appendChild","mergeStyle","onMouseClick","bind","forEach","name","addEventListener","toLowerCase","e","push","preventDefault","passive","toDataURL","style","fillStyle","replace","clearRect","drawText","node","offsetX","offsetY","text","x","y","fillText","drawImage","sx","sy","swidth","sheight","drawBack","backgroundImage","backgroundColor","save","beginPath","rect","fill","closePath","restore","createPattern","drawBorder","borderWidth","borderColor","stroke","translate","box","transform","rotate","scale","angle","Math","PI","scaleX","scaleY","drawCircle","cx","cy","r","sAngle","eAngle","counterclockwise","strokeWidth","arc","drawLine","x1","y1","x2","y2","moveTo","lineTo","drawRect","parent","renderRect","renderPrimitive","start","left","center","right","end","alphabetic","hanging","ideographic","top","middle","bottom","child","renderNode","event","onMouseMove","runEvent","onClick","moveEventTarget","render","root","self","$root","Sound","current","Soundes","sounds","control","loop","play","pause","createInstance","next","Class","instance","create","destoryInstance","pre","length","pop","updateInstance","patchNode","key","preChildren","nextChildren","max","i","Engine","Game","$state","Object","$foucs","$sound","ui","gameStart","location","protocol","alert","navigator","userAgent","match","RegExp","$1","gameStop","cancelAnimationFrame","ident","frame","keyFrame","requestAnimationFrame","FPS","fps","styles","timeStamp","Date","min","toFixed","Loading","step","sin","msg","Select","select","activeIndex","assign","onKeyDown","code","options","onChange","onConfirm","onClose","index","size","map","item","optionStyle","setStorage","localStorage","setItem","JSON","stringify","getStorage","parse","getItem","saveGame","saveData","loadGame","Title","title","gameName","isLoad","onLoadMap","itemOption","statusOption","loadGameOption","saveGameOption","detailOption","Menu","tick","menu","detail","Shop","shop","shopid","need","effect","choices","onShopEvent","split","Battle","battle","enemy","hero","battleMsg","hostname","hp","turn","atk","def","exp","money","proprety","heroImageStyle","enemyImageStyle","vsStyle","msgStyle","Talk","talk","talks","substr","leftStyle","rightStyle","calcLength","str","len","charCodeAt","Message","onMessageClose","EnemyInfo","enemys","keys","enemyId","cost","atkCount","floor","ShopList","shops","entries","isCoincided","A","B","updateVector","vector","obj","assignVector","convertPropertyStr","arr","unshift","propertyStr","properties","v","formatText","data","shift","row","trim","id","includes","isNaN","Number","propertyNames","lv","Hero","position","isCoincidedTerrains","heroStyle","mapTerrains","findIndex","isCoincidedEvents","mapEvents","styleHero","moveVector","showEnemyInfo","buying","log","terrain","eventIndex","handleEvents","onShopClose","setEvent","mapEvent","info","mapping","items","remove","updateSaveData","property","propertyName","slice","removeMapEvent","onTitle","mapId","condition","true","trueEvent","false","falseEvent","checkSaveData","error","onBattleClose","onMenuClose","showMenu","gets","n","some","onShopListClose","onShopListConfirm","Talks","Status","walls","rowProperty","game","yellowKey","blueKey","redKey","Map","interval","statusBar","bgm","renderMapTerrains","status","terrains","line","renderMapEvents","events","onRemoveMapEvent","ScrollText","scroll","ready","loadImage","Promise","resolve","reject","img","Image","loadSound","audio","Audio","loadJSON","url","fetch","then","json","loadText","loadFont","fontface","FontFace","add","load","loaded","loaderMap","sprite","arr3","concat","loaderData","all","endsWith","animates","icons","npcs","boss","loadImages","o2","loaderImage","loaderMusic","loadSounds","loaderFont","sound","loadMap","app","loading","randMapKey","onEvent"],"mappings":"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"}